<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Frases com Áudio</title>
  <style>
    .highlight {
      color: red;
      font-weight: bold;
    }
    .controls {
      margin: 5px 0;
    }
    button, select {
      margin: 0 3px;
    }
  </style>
</head>
<body>
  <div id="sentences-container"></div>

  <script>
    // Exemplo de frases (simulando o que viria da planilha)
    const verses = [
  {
    ref: "Gênesis 1:1",
    enText: "In the beginning God created the heavens and the earth.",
    ptText: "No princípio Deus criou os céus e a terra.",
    enFile: "audio1-en.mp3",
    ptFile: "audio1-pt.mp3"
  },
  {
    ref: "Gênesis 1:2",
    enText: "Now the earth was formless and desolate, and there was darkness upon the surface of the watery deep, and God’s active force was moving about over the surface of the waters.",
    ptText: "A terra era vazia e deserta, e havia escuridão sobre as águas profundas; e a força ativa de Deus movia-se sobre as águas.",
    enFile: "audio2-en.mp3",
    ptFile: "audio2-pt.mp3"
  },
  {
    ref: "Gênesis 1:3",
    enText: "And God said, 'Let there be light,' and there was light.",
    ptText: "Então Deus disse: 'Que haja luz.' E houve luz.",
    enFile: "audio3-en.mp3",
    ptFile: "audio3-pt.mp3"
  }
];


    function renderSentences() {
      const container = document.getElementById("sentences-container");
      container.innerHTML = "";

      sentences.forEach((s, i) => {
        const div = document.createElement("div");
        div.style.marginBottom = "20px";

        ["en", "pt"].forEach(lang => {
          const text = s[lang];
          const audioSrc = lang === "en" ? s.audioEn : s.audioPt;

          // Divide em palavras (cada uma clicável)
          const words = text.split(" ").map((word, wi) => {
            return `<span class="word" data-index="${wi}" onclick="jumpToWord(${i}, '${lang}', ${wi})">${word}</span>`;
          }).join(" ");

          div.innerHTML += `
            <p><strong>${lang.toUpperCase()}:</strong> <span id="text-${lang}-${i}">${words}</span></p>
            <div class="controls">
              <audio id="audio-${lang}-${i}" src="${audioSrc}"></audio>
              <button onclick="togglePlay(${i}, '${lang}')">▶️ Play/Pause</button>
              <button onclick="skipTime(${i}, '${lang}', -5)">⏪ -5s</button>
              <button onclick="skipTime(${i}, '${lang}', 5)">+5s ⏩</button>
              <label for="speed-${i}-${lang}">Velocidade:</label>
              <select id="speed-${i}-${lang}" onchange="changeSpeed(${i}, '${lang}', this.value)">
                <option value="0.75">0.75x</option>
                <option value="1" selected>1x</option>
                <option value="1.25">1.25x</option>
                <option value="1.5">1.5x</option>
              </select>
            </div>
          `;
        });

        container.appendChild(div);
      });
    }

    // Reproduzir / pausar
    function togglePlay(index, lang) {
      const audio = document.getElementById(`audio-${lang}-${index}`);
      if (audio.paused) {
        audio.play();
        highlightWords(index, lang);
      } else {
        audio.pause();
      }
    }

    // Mudar velocidade
    function changeSpeed(index, lang, value) {
      const audio = document.getElementById(`audio-${lang}-${index}`);
      audio.playbackRate = parseFloat(value);
    }

    // Retroceder / avançar
    function skipTime(index, lang, seconds) {
      const audio = document.getElementById(`audio-${lang}-${index}`);
      audio.currentTime = Math.max(0, audio.currentTime + seconds);
    }

    // Destacar palavras sincronizadas
    function highlightWords(index, lang) {
      const audio = document.getElementById(`audio-${lang}-${index}`);
      const textContainer = document.getElementById(`text-${lang}-${index}`);
      const words = textContainer.querySelectorAll(".word");

      const totalWords = words.length;
      const duration = audio.duration || 1;

      function step() {
        const current = audio.currentTime;
        const progress = current / duration;
        const wordIndex = Math.floor(progress * totalWords);

        words.forEach((w, wi) => {
          w.classList.toggle("highlight", wi === wordIndex);
        });

        if (!audio.paused && !audio.ended) {
          requestAnimationFrame(step);
        }
      }

      requestAnimationFrame(step);
    }

    // Pular para palavra clicada
    function jumpToWord(index, lang, wordIndex) {
      const audio = document.getElementById(`audio-${lang}-${index}`);
      const textContainer = document.getElementById(`text-${lang}-${index}`);
      const words = textContainer.querySelectorAll(".word");

      const duration = audio.duration || 1;
      const totalWords = words.length;
      const time = (wordIndex / totalWords) * duration;

      audio.currentTime = time;
      if (audio.paused) {
        audio.play();
      }
      highlightWords(index, lang);
    }

    renderSentences();
  </script>
</body>
</html>
